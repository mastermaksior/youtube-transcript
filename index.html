<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Transkrypcja YouTube</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
    textarea { width: 100%; height: 400px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Transkrypcja filmu YouTube</h1>
  <input type="text" id="videoId" placeholder="Wklej ID filmu lub URL" style="width:100%; padding:10px;" />
  <button onclick="getTranscript()">Pobierz transkrypcję</button>
  <textarea id="transcript" placeholder="Tutaj pojawi się transkrypcja..."></textarea>

  <script>
    function extractVideoId(url) {
      const regex = /(?:youtube\.com.*[?&]v=|youtu\.be\/)([^&\n?#]+)/;
      const match = url.match(regex);
      return match ? match[1] : url;
    }

    async function getTranscript() {
      const input = document.getElementById('videoId').value.trim();
      const videoId = extractVideoId(input);
      const transcriptBox = document.getElementById('transcript');
      transcriptBox.value = "Pobieranie transkrypcji...";

      const url = `https://video.google.com/timedtext?lang=en&v=${videoId}`;
      try {
        const response = await fetch(url);
        const xml = await response.text();
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xml, "text/xml");
        const texts = xmlDoc.getElementsByTagName("text");

        let transcript = "";
        for (let i = 0; i < texts.length; i++) {
          transcript += texts[i].textContent + " ";
        }
        transcriptBox.value = transcript || "Brak transkrypcji (napisów) dla tego filmu.";
      } catch (err) {
        transcriptBox.value = "Błąd podczas pobierania transkrypcji.";
      }
    }
  </script>
</body>
</html>
